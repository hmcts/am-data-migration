#!groovy

@Library('Infrastructure') _

properties([
    parameters([
        choice(name: 'ENVIRONMENT', choices: 'saat\nsprod\naat\nprod', description: 'Environment where migration should be run'),
        choice(name: 'SUBSCRIPTION', choices: 'sandbox\nnonprod\nprod', description: 'Azure subscriptions available to build in')
    ])
])

pipeline {
    agent any
    stages {
        stage('Checkout') {
            steps {
                checkout scm
            }
        }

        stage('Run migration script') {
            steps {
                sh './ccd-to-am-migration-runner.sh localhost 5432 am amuser ccd-to-am-migration-main.sql'
            }
        }
    }
}
